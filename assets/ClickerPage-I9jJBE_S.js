import{Q as f,i as _}from"./QBtn-Td1wNIG3.js";import{Q as w}from"./QPage-B7pu43Wj.js";import{V as S,r as n,B,o as N,_ as j,W as x,X as r,Y as q,a5 as o,a2 as y,a3 as k,Z as v,a4 as T,a1 as p}from"./index-BXuH1jaJ.js";import"./render-BVZrOPwd.js";const G=S({name:"ClickerPage",setup(){const e=n(0),t=n(0),i=n(0),u=n(""),l=n(!1),s=n("idle"),m=n([]);let c=null;const b=()=>{s.value==="playing"&&(t.value++,m.value.push({score:t.value,timeLeft:i.value}))},g=async()=>{if(s.value==="idle"){s.value="submitting",t.value=0,m.value=[],l.value=!1;try{const d=await(await fetch("https://timer-backend-24n3.vercel.app/api/getToken",{method:"POST"})).json();if(!d.token)throw new Error("Token missing");u.value=d.token}catch(a){console.error("Nepodarilo sa na캜칤ta콘 token:",a),s.value="idle";return}s.value="playing",i.value=5e3,c=window.setInterval(()=>{i.value-=100,i.value<=0&&(clearInterval(c),h())},100)}},h=async()=>{s.value="submitting",c&&clearInterval(c);try{const a=await fetch("https://timer-backend-24n3.vercel.app/api/clickerSubmit",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({score:t.value,token:u.value,clicks:m.value})}),d=await a.json();a.ok?(l.value=!!d.isNewBest,l.value?e.value=t.value:e.value=d.previousBest??e.value):(console.error("Chyba:",d.error),l.value=!1)}catch(a){console.error("Chyba pri odosielan칤:",a),l.value=!1}s.value="done",u.value=""},C=()=>{s.value="idle",t.value=0,m.value=[],l.value=!1};return B(()=>{c&&clearInterval(c)}),N(()=>{fetch("https://timer-backend-24n3.vercel.app/api/getClickerScore").then(a=>a.json()).then(a=>a.score||0).then(a=>{e.value=a}).catch(()=>0)}),{minimumScore:e,score:t,timeLeft:i,state:s,click:b,startGame:g,endGame:h,resetGame:C,isNewBest:l}}}),I={class:"column items-center q-pa-lg q-gutter-md text-center max-w-md"},P={class:"text-subtitle1"},Q={class:"q-mt-md"},V={key:0},z={key:1},$={class:"text-h5 q-mb-sm"},L={class:"q-mt-sm text-accent"},O={key:2},D={key:3},E={class:"text-h5"},K={key:0,class:"text-green text-h6"},A={key:1,class:"text-grey text-h6"};function F(e,t,i,u,l,s){return r(),x(w,{class:"flex flex-center bg-black text-white"},{default:q(()=>[o("div",I,[t[3]||(t[3]=o("div",{class:"text-h3 text-bold"},"Clicker",-1)),o("div",P,[t[0]||(t[0]=y(" Klikaj 캜o najr칳chlej코ie po캜as 5 sek칰nd!",-1)),t[1]||(t[1]=o("br",null,null,-1)),y(" Ak prekon치코 svoje sk칩re "+k(e.minimumScore)+", z칤ska코 free spin ",1)]),o("div",Q,[e.state==="idle"?(r(),v("div",V,[p(f,{color:"primary",label:"맚art",onClick:e.startGame},null,8,["onClick"])])):e.state==="playing"?(r(),v("div",z,[o("div",$,"Sk칩re: "+k(e.score),1),p(f,{color:"secondary",label:"Klikni!",onClick:e.click},null,8,["onClick"]),o("div",L,"캛as: "+k((e.timeLeft/1e3).toFixed(1))+" s",1)])):e.state==="submitting"?(r(),v("div",O,[p(_,{color:"white",size:"2em"}),t[2]||(t[2]=o("div",{class:"q-mt-sm"},"Sprac칰vam v칳sledok...",-1))])):e.state==="done"?(r(),v("div",D,[o("div",E,"Tvoje sk칩re: "+k(e.score),1),e.isNewBest?(r(),v("div",K,"游댠 Nov칳 rekord!")):(r(),v("div",A,"Sk칰s to znova!")),p(f,{color:"primary",label:"Hra콘 znova",onClick:e.resetGame,class:"q-mt-md"},null,8,["onClick"])])):T("",!0)])])]),_:1})}const W=j(G,[["render",F],["__scopeId","data-v-f1780636"]]);export{W as default};
